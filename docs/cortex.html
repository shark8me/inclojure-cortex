<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Deep learning with Cortex</title>
<meta name="author" content="(Kiran Karkera)"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/reveal.css"/>

<link rel="stylesheet" href="http://cdn.jsdelivr.net/reveal.js/3.0.0/css/theme/moon.css" id="theme"/>

<link rel="stylesheet" href="./night.css"/>

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'http://cdn.jsdelivr.net/reveal.js/3.0.0/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1>Deep learning with Cortex</h1><h2>Kiran Karkera</h2><h3><a href="mailto:Datacraft Sciences">Datacraft Sciences</a></h3>
</section>

<section>
<section id="slide-org25483a8">
<h2 id="org25483a8">Outline</h2>
<p>
Context: Clojure, Cortex, Machine Learning
</p>
<p class="fragment appear">
Overview of Cortex
</p>
<p class="fragment appear">
Example of building networks 
</p>
<p class="fragment appear">
Recipes 
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgfaa7f41">
<h2 id="orgfaa7f41">Context</h2>
<p>
Machine learning/data science is an overloaded term
</p>

</section>
<section >


<div class="figure">
<p><img src="./images/blind_men.jpg" alt="blind_men.jpg" style="margin: 0 auto; display:block;" />
</p>
</div>

</section>
<section >

<div class="slide-footer"></div>
</section>
<section id="slide-orgae0e7a2">
<h3 id="orgae0e7a2">Estimation vs Prediction</h3>
<p class="fragment appear">
Estimation: coming up with values of unknown parameters (in a model)  
</p>

<p class="fragment appear">
Prediction: focused on accuracy (and other metrics) of model.
</p>

<aside class="notes">
<ul>
<li>Examine causes of diseases</li>
<li>Example: image classification</li>

</ul>

</aside>

<div class="slide-footer"></div>
</section>
<section id="slide-orge6b97cf">
<h3 id="orge6b97cf">Research vs production use</h3>
<p class="fragment appear">
Exploration (given a dataset, train a classifier, produce a report) 
</p>

<p class="fragment appear">
Production (putting a trained model into a production environment)
</p>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org37d4dc9">
<h2 id="org37d4dc9">Why use Clojure for Machine Learning?</h2>
<p class="fragment appear">
Data-oriented functional programming with a focus on composable sequence processing 
</p>
<p class="fragment appear">
Excellent tooling for REPL-driven development
</p>
<p class="fragment appear">
Interop with Java, Scala and Javascript 
</p>
<p class="fragment appear">
Smooth transition from research to production
</p>

</section>
<section >

<div class="figure">
<p><img src="./images/datascienceaxes.png" alt="datascienceaxes.png" />
</p>
</div>

</section>
<section >

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<tbody>
<tr>
<td class="org-left"><b>Library</b></td>
<td class="org-left"><b>Niche</b></td>
</tr>

<tr>
<td class="org-left">Gorilla-repl</td>
<td class="org-left">Notebooks/visualization</td>
</tr>

<tr>
<td class="org-left">Storm</td>
<td class="org-left">Stream processing</td>
</tr>

<tr>
<td class="org-left">Onyx</td>
<td class="org-left">Stream Processing</td>
</tr>

<tr>
<td class="org-left">Sparkling/Flambo</td>
<td class="org-left">Distributed jobs on Spark</td>
</tr>

<tr>
<td class="org-left">Datomic</td>
<td class="org-left">Supports "time travel" over database history</td>
</tr>
</tbody>
</table>


<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org43cfc4a">
<h2 id="org43cfc4a">What is Machine Learning</h2>
<div class="outline-text-2" id="text-org43cfc4a">
</div>
<div class="slide-footer"></div>
</section>
<section id="slide-org095c1fe">
<h4 id="org095c1fe">Supervised Classification:</h4>

<div class="figure">
<p><img src="./images/woof_meow.jpg" alt="woof_meow.jpg" style="margin: 0 auto; display:block;" />
</p>
</div>


<div class="slide-footer"></div>
</section>
<section id="slide-orga257052">
<h3 id="orga257052">Why are Neural Networks popular for classification?</h3>
<div class="outline-text-3" id="text-orga257052">
</div>
<div class="slide-footer"></div>
</section>
<section id="slide-orgfb07bba">
<h4 id="orgfb07bba">State of the art performance</h4>
</section>
<section >
<p>
One of the early successes(1992) for neural nets was reading <a href="http://yann.lecun.com/exdb/publis/pdf/matan-92.pdf">the zip code</a> in postal mail.
</p>


<div class="figure">
<p><img src="./images/MNIST.png" alt="MNIST.png" style="margin: 0 auto; display:block;" /> 
</p>
</div>

<p class="fragment appear">
99.81% accuracy on MNIST, close to or better than human performance
</p>

<div class="slide-footer"></div>
</section>
<section id="slide-orgd1fd207">
<h4 id="orgd1fd207">Flexibility</h4>
<p>
Neural Nets can accommodate several outputs:
</p>
<p class="fragment appear">
Single target classification (e.g. Spam classification)
</p>
<p class="fragment appear">
Multi target classification (e.g multiple objects in an image)
</p>

<p class="fragment appear">
Classifying aspects of human faces such as gender, age, type of expression and skin colour
</p>


<div class="figure">
<p><img src="./images/face_gender.png" alt="face_gender.png" class="fragment appear" style="margin: 0 auto; display:block;" />
</p>
</div>

</section>
<section >

<div class="slide-footer"></div>
</section>
<section id="slide-orge200ef8">
<h4 id="orge200ef8">Composable abstractions</h4>
<p class="fragment appear">
Different layers can be combined in a <a href="http://colah.github.io/posts/2014-07-Conv-Nets-Modular/" class="fragment appear">modular fashion</a> and computations are straightforward
</p>

</section>
<section >

<div class="figure">
<p><img src="./images/example_captions.jpg" alt="example_captions.jpg" style="margin: 0 auto; display:block;" height="70%," width="70%" />
</p>
<p><span class="figure-number">Figure 6: </span>im2txt network provides descriptions of images</p>
</div>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org15d0d84">
<h2 id="org15d0d84">Features of Cortex</h2>
<p>
Deep learning library written in Clojure
</p>
<p class="fragment appear">
Data centric interface
</p>
<p class="fragment appear">
Performant, Memory efficient training on GPUs
</p>
<p class="fragment appear">
Supports Convolutional NNs (image processing)
</p>
<p class="fragment appear">
Partial support for ingesting pre-trained networks
</p>
<p class="fragment appear">
Abstraction layers for CUDA / CPU
</p>
<ul class="fragment appear">
<li>Enables some level of shared implementation between a Cpu, Cuda, OpenCL</li>

</ul>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgcb1fe0a">
<h2 id="orgcb1fe0a">Cortex Examples</h2>
<div class="outline-text-2" id="text-orgcb1fe0a">
</div>
<div class="slide-footer"></div>
</section>
<section id="slide-org1427b0a">
<h3 id="org1427b0a">Predicting office room occupancy</h3>

<div class="figure">
<p><img src="./images/office_occupancy.jpg" alt="office_occupancy.jpg" style="margin: 0 auto; display:block;" height="70%" />
</p>
</div>

</section>
<section >

<p class="fragment appear">
Train with 8k instances from <a href="http://archive.ics.uci.edu/ml/datasets/Occupancy+Detection+" class="fragment appear">room occupancy</a> dataset 
</p>

<p class="fragment appear">
Contains measurements of light, temperature, humidity and CO2 of an office room. 
</p>

<p class="fragment appear">
Goal is to predict when the room is occupied.
</p>

</section>
<section >


<div class="figure">
<p><img src="./images/occupancy_dataset.png" alt="occupancy_dataset.png" style="margin: 0 auto; display:block;" />
</p>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org4c04704">
<h4 id="org4c04704">Data ingestion</h4>
<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #7590db;">data-vectors</span> <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;&gt;</span> <span style="color: #2d9574;">"resources/occupancy/datatraining.csv"</span>
                       <span style="color: #2d9574;">(</span>slurp<span style="color: #2d9574;">)</span>
                       <span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">parse lines   </span>
                       <span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #4f97d7;">(</span>take <span style="color: #a45bad;">2</span> data-vectors<span style="color: #4f97d7;">)</span>

</pre>
</div>

<hr />

<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">23.18</span> <span style="color: #a45bad;">27.272</span> <span style="color: #a45bad;">426.0</span> <span style="color: #a45bad;">721.25</span> <span style="color: #a45bad;">0.00479298817650529</span> <span style="color: #a45bad;">1.0</span><span style="color: #bc6ec5;">]</span> 
 <span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">23.15</span> <span style="color: #a45bad;">27.2675</span> <span style="color: #a45bad;">429.5</span> <span style="color: #a45bad;">714.0</span> <span style="color: #a45bad;">0.00478344094931065</span> <span style="color: #a45bad;">1.0</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
</pre>
</div>


<div class="slide-footer"></div>
</section>
<section id="slide-org6afb4b2">
<h4 id="org6afb4b2">Create training data format</h4>
<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defn</span> <span style="color: #bc6ec5; font-weight: bold;">make-feature-vec</span>
  <span style="color: #bc6ec5;">[</span>data-vectors<span style="color: #bc6ec5;">]</span>
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;&gt;</span> data-vectors 
       <span style="color: #2d9574;">(</span>mapv <span style="color: #67b11d;">(</span><span style="color: #4f97d7; font-weight: bold;">fn</span><span style="color: #b1951d;">[</span>m<span style="color: #b1951d;">]</span> <span style="color: #b1951d;">{</span><span style="color: #a45bad;">:data</span> <span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;</span> m butlast vec<span style="color: #4f97d7;">)</span> <span style="color: #a45bad;">:labels</span> <span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;</span> m last vector<span style="color: #4f97d7;">)</span><span style="color: #b1951d;">}</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;&gt;</span> <span style="color: #bc6ec5;">(</span>make-feature-vec data-vectors<span style="color: #bc6ec5;">)</span>
     <span style="color: #bc6ec5;">(</span>take <span style="color: #a45bad;">2</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

</pre>
</div>

<hr />


<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #bc6ec5;">{</span>:data <span style="color: #2d9574;">[</span><span style="color: #a45bad;">22.15</span> <span style="color: #a45bad;">27.245</span> <span style="color: #a45bad;">0.0</span> <span style="color: #a45bad;">586.5</span> <span style="color: #a45bad;">0.0044959713579516</span><span style="color: #2d9574;">]</span>, :labels <span style="color: #2d9574;">[</span><span style="color: #a45bad;">0.0</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">}</span> 
 <span style="color: #bc6ec5;">{</span>:data <span style="color: #2d9574;">[</span><span style="color: #a45bad;">20.89</span> <span style="color: #a45bad;">23.445</span> <span style="color: #a45bad;">0.0</span> <span style="color: #a45bad;">450.5</span> <span style="color: #a45bad;">0.00357640828064061</span><span style="color: #2d9574;">]</span>, :labels <span style="color: #2d9574;">[</span><span style="color: #a45bad;">1.0</span><span style="color: #2d9574;">]</span><span style="color: #bc6ec5;">}</span><span style="color: #4f97d7;">)</span>

</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-orgcaee746">
<h4 id="orgcaee746">Split the data into train and test</h4>

<div class="slide-footer"></div>
</section>
<section id="slide-org512f7fb">
<h3 id="org512f7fb">Define the layers</h3>
<p>
Network is defined as a vector of layers
</p>
<p class="fragment appear">
Input layer take 3 arguments, the <b>x y z</b> dimensions of the input cube
</p>
<p class="fragment appear">
Specify the input against the :id key 
</p>

<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">input layer for room occupancy is 5(inputs) x 1 x 1 </span>
<span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>input <span style="color: #a45bad;">5</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:data</span><span style="color: #4f97d7;">)</span>

</pre>
</div>


<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">data instance</span>
<span style="color: #4f97d7;">{</span><span style="color: #a45bad;">:data</span> <span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">22.15</span> <span style="color: #a45bad;">27.245</span> <span style="color: #a45bad;">0.0</span> <span style="color: #a45bad;">586.5</span> <span style="color: #a45bad;">0.0044959713579516</span><span style="color: #bc6ec5;">]</span>, <span style="color: #a45bad;">:labels</span> <span style="color: #bc6ec5;">[</span><span style="color: #a45bad;">0.0</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">}</span>
</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org9515b66">
<h4 id="org9515b66">Network definition</h4>
<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #7590db;">description</span>
  <span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>input <span style="color: #a45bad;">5</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:data</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>batch-normalization<span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>linear <span style="color: #a45bad;">1</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>logistic <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:labels</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

</pre>
</div>

</section>
<section >

<div class="figure">
<p><img src="./images/occupancy_network.png" alt="occupancy_network.png" />
</p>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-orgc1672e0">
<h4 id="orgc1672e0">Training</h4>
<p>
Train it for 10 <b>epochs</b>
</p>
<p class="fragment appear">
One epoch == One pass on the dataset 
</p>

<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #7590db;">trained-occupancy-net</span> 
  <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">let</span> <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span>train-ds test-ds<span style="color: #67b11d;">]</span> train-test-ds<span style="color: #2d9574;">]</span>
    <span style="color: #2d9574;">(</span>train-n description train-ds test-ds                            
             <span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">run for 10 training epochs</span>
             <span style="color: #a45bad;">:epoch-count</span> <span style="color: #a45bad;">10</span> <span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

</pre>
</div>

<div class="org-src-container">

<pre  class="fragment appear">|     :type |              :value | :lambda | :node-id | :argument |
|-----------+---------------------+---------+----------+-----------|
| :mse-loss | <span style="color: #a45bad;">0.03046061750823965</span> |     <span style="color: #a45bad;">1.0</span> |  :labels |           |

Loss for epoch  <span style="color: #a45bad;">10:</span> <span style="color: #4f97d7;">(</span>current<span style="color: #4f97d7;">)</span> <span style="color: #a45bad;">0.03046062</span> <span style="color: #4f97d7;">(</span>best<span style="color: #4f97d7;">)</span> <span style="color: #a45bad;">0.03308501</span> <span style="color: #4f97d7;">[</span>new best<span style="color: #4f97d7;">]</span>

</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org80aa213">
<h4 id="org80aa213">Evaluate results</h4>
<p>
Evaluate the accuracy (and other metrics) on the test set
</p>

<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">[</span><span style="color: #bc6ec5;">(</span>accuracy actual predicted<span style="color: #bc6ec5;">)</span> <span style="color: #bc6ec5;">(</span>f1-score actual predicted <span style="color: #a45bad;">1.0</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">]</span>
</pre>
</div>

<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">[</span><span style="color: #a45bad;">0.9447852760736196</span> <span style="color: #a45bad;">0.8888888888888891</span><span style="color: #4f97d7;">]</span>
</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org899408a">
<h3 id="org899408a">Recognizing hand-written digits</h3>

<div class="figure">
<p><img src="./images/mnist-sample.png" alt="mnist-sample.png" style="margin: 0 auto; display:block;" height="70%" />
</p>
</div>

<p class="fragment appear">
Image of size 28 (length) x 28 (breadth) x 3 (depth)
</p>

<div class="slide-footer"></div>
</section>
<section id="slide-orgddfa08a">
<h4 id="orgddfa08a">Network definition</h4>
<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">input layer for an image of size 28 (length) x 28 (breadth) x 3 (depth)</span>
<span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>input <span style="color: #a45bad;">28</span> <span style="color: #a45bad;">28</span> <span style="color: #a45bad;">3</span> <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:data</span><span style="color: #4f97d7;">)</span>

</pre>
</div>


</section>
<section >
<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defn</span> <span style="color: #bc6ec5; font-weight: bold;">mnist-initial-description</span>
  <span style="color: #bc6ec5;">[</span>input-w input-h num-classes<span style="color: #bc6ec5;">]</span>
  <span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>input input-w input-h <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:data</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>convolutional <span style="color: #a45bad;">5</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">20</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>max-pooling <span style="color: #a45bad;">2</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">2</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>relu<span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>convolutional <span style="color: #a45bad;">5</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">50</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>max-pooling <span style="color: #a45bad;">2</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">2</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>batch-normalization<span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>linear <span style="color: #a45bad;">1000</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>relu <span style="color: #a45bad;">:center-loss</span> <span style="color: #67b11d;">{</span><span style="color: #a45bad;">:label-indexes</span> <span style="color: #b1951d;">{</span><span style="color: #a45bad;">:stream</span> <span style="color: #a45bad;">:labels</span><span style="color: #b1951d;">}</span>
                              <span style="color: #a45bad;">:label-inverse-counts</span> <span style="color: #b1951d;">{</span><span style="color: #a45bad;">:stream</span> <span style="color: #a45bad;">:labels</span><span style="color: #b1951d;">}</span>
                              <span style="color: #a45bad;">:labels</span> <span style="color: #b1951d;">{</span><span style="color: #a45bad;">:stream</span> <span style="color: #a45bad;">:labels</span><span style="color: #b1951d;">}</span>
                              <span style="color: #a45bad;">:alpha</span> <span style="color: #a45bad;">0.9</span>
                              <span style="color: #a45bad;">:lambda</span> <span style="color: #a45bad;">1e-4</span><span style="color: #67b11d;">}</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>dropout <span style="color: #a45bad;">0.5</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>linear num-classes<span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>softmax <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:labels</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org89268c7">
<h4 id="org89268c7">Training progress</h4>

<div class="figure">
<p><img src="./images/mnist_webserver.png" alt="mnist_webserver.png" style="margin: 0 auto; display:block;" height="100%" width="120%" />
</p>
</div>

</section>
<section >
<p><video data-autoplay width="180%" src="./images/5_3.mkv" loop ></video></p>

</section>
<section >

<div class="figure">
<p><img src="./images/mnist_test_loss.png" alt="mnist_test_loss.png" />
</p>
</div>

</section>
<section >

<div class="figure">
<p><img src="./images/tensorboard_mnist_weights.png" alt="tensorboard_mnist_weights.png" />
</p>
</div>

</section>
<section >

<div class="figure">
<p><img src="./images/tboard_mnist_convbias.png" alt="tboard_mnist_convbias.png" />
</p>
</div>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org651d3f1">
<h2 id="org651d3f1">Backpropagation</h2>

<div class="figure">
<p><img src="./images/dartboard.jpg" alt="dartboard.jpg" />
</p>
</div>
<div class="slide-footer"></div>
</section>
<section id="slide-orgf8663c3">
<h4 id="orgf8663c3">Artifacts</h4>
<p class="fragment appear">
Forward pass
</p>
<p class="fragment appear">
Backward pass
</p>
<p class="fragment appear">
Accuracy / Loss function
</p>
<p class="fragment appear">
Gradient
</p>

<div class="slide-footer"></div>
</section>
<section id="slide-org2e3c2ce">
<h3 id="org2e3c2ce">How to train neural networks (theory)</h3>
<p class="fragment appear">
(Learn by) writing a toy implementation of back propagation 
</p>

<p class="fragment appear">
Stack up layers like Lego blocks
</p>

<p class="fragment appear">
Sip your coffee and watch the loss function decrease
</p>

</section>
<section >


<div class="figure">
<p><img src="./images/ideallossfunction1.png" alt="ideallossfunction1.png" style="margin: 0 auto; display:block;" />
</p>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org68457a6">
<h3 id="org68457a6">Reality</h3>
<p>
<b>" The problem with Backpropagation is that it is a leaky abstraction."</b>
-Andrej Karpathy
</p>

</section>
<section >


<div class="figure">
<p><img src="./images/lossfunction_heartrate.png" alt="lossfunction_heartrate.png" style="margin: 0 auto; display:block;" />
</p>
<p><span class="figure-number">Figure 17: </span>A heart rate or a loss function? :)</p>
</div>

</section>
<section >


<div class="figure">
<p><img src="./images/lossfunction2.png" alt="lossfunction2.png" style="margin: 0 auto; display:block;" />
</p>
<p><span class="figure-number">Figure 18: </span>Evades diagnosis</p>
</div>

<p>
Check out <a href="https://lossfunctions.tumblr.com/">this page</a> for artistic loss functions
</p>

</section>
<section >

<div class="figure">
<p><img src="./images/xkcd.png" alt="xkcd.png" style="margin: 0 auto; display:block;" />
</p>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org96745b5">
<h3 id="org96745b5">Debug-ability is key</h3>
<p class="fragment appear">
Swanky UIs are common
</p>

<p class="fragment appear">
Swanky REPL are surprisingly rare
</p>

</section>
<section >
<p class="fragment appear">
<b>“Any Product That Needs a Manual to Work Is Broken” – Elon Musk</b>
</p>

<div class="slide-footer"></div>
</section>
<section id="slide-orga881b77">
<h3 id="orga881b77">Neural nets and functional programming</h3>
<p class="fragment appear">
Pure functions
</p>
<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span>layer inputs<span style="color: #4f97d7;">)</span>
</pre>
</div>

</section>
<section >
<p>
Reduce 
</p>
<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span>reduce <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">fn</span><span style="color: #2d9574;">[</span>last-output layer<span style="color: #2d9574;">]</span>  
            <span style="color: #2d9574;">(</span>layer last-output<span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span> 

            input
            <span style="color: #bc6ec5;">[</span>layer1 layer2 layer3<span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>
</pre>
</div>


</section>
<section >
<p class="fragment appear">
Iterate 
</p>
<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span>iterate train-fn initial-network<span style="color: #4f97d7;">)</span>
</pre>
</div>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-org78f59a4">
<h2 id="org78f59a4">REPL driven development</h2>
<div class="outline-text-2" id="text-org78f59a4">
</div>
<div class="slide-footer"></div>
</section>
<section id="slide-org0364044">
<h3 id="org0364044">Querying network properties (a.k.a -&gt;)</h3>
<div class="outline-text-3" id="text-org0364044">
</div>
<div class="slide-footer"></div>
</section>
<section id="slide-org3545e99">
<h4 id="org3545e99">What are the layers in the network</h4>
<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;</span> occupancy-net <span style="color: #a45bad;">:compute-graph</span> <span style="color: #a45bad;">:nodes</span> keys<span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">(</span><span style="color: #2aa1ae; background-color: #292e34;">:data</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:batch-normalization-1</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:linear-1</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:labels</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:mse-loss-1</span><span style="color: #2aa1ae; background-color: #292e34;">)</span>
</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-orgdb0d64f">
<h4 id="orgdb0d64f">How are layers connected</h4>
<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;</span> occupancy-net <span style="color: #a45bad;">:compute-graph</span> <span style="color: #a45bad;">:edges</span><span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">([</span><span style="color: #2aa1ae; background-color: #292e34;">:data</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:batch-normalization-1</span><span style="color: #2aa1ae; background-color: #292e34;">] </span>
<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">[</span><span style="color: #2aa1ae; background-color: #292e34;">:batch-normalization-1</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:linear-1</span><span style="color: #2aa1ae; background-color: #292e34;">] </span>
<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">[</span><span style="color: #2aa1ae; background-color: #292e34;">:linear-1</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:labels</span><span style="color: #2aa1ae; background-color: #292e34;">] </span>
<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">[</span><span style="color: #2aa1ae; background-color: #292e34;">:labels</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:mse-loss-1</span><span style="color: #2aa1ae; background-color: #292e34;">])</span>
</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-orgd2dbb01">
<h4 id="orgd2dbb01">Examine weights per layer</h4>
<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">defn</span> <span style="color: #bc6ec5; font-weight: bold;">mnist-initial-description</span>
  <span style="color: #bc6ec5;">[</span>input-w input-h num-classes<span style="color: #bc6ec5;">]</span>
  <span style="color: #bc6ec5;">[</span><span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>input input-w input-h <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:data</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>convolutional <span style="color: #a45bad;">5</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">20</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>max-pooling <span style="color: #a45bad;">2</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">2</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>relu<span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>convolutional <span style="color: #a45bad;">5</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">1</span> <span style="color: #a45bad;">50</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>max-pooling <span style="color: #a45bad;">2</span> <span style="color: #a45bad;">0</span> <span style="color: #a45bad;">2</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>batch-normalization<span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>linear <span style="color: #a45bad;">1000</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>relu <span style="color: #a45bad;">:center-loss</span> <span style="color: #67b11d;">{</span><span style="color: #a45bad;">:label-indexes</span> <span style="color: #b1951d;">{</span><span style="color: #a45bad;">:stream</span> <span style="color: #a45bad;">:labels</span><span style="color: #b1951d;">}</span>
                              <span style="color: #a45bad;">:label-inverse-counts</span> <span style="color: #b1951d;">{</span><span style="color: #a45bad;">:stream</span> <span style="color: #a45bad;">:labels</span><span style="color: #b1951d;">}</span>
                              <span style="color: #a45bad;">:labels</span> <span style="color: #b1951d;">{</span><span style="color: #a45bad;">:stream</span> <span style="color: #a45bad;">:labels</span><span style="color: #b1951d;">}</span>
                              <span style="color: #a45bad;">:alpha</span> <span style="color: #a45bad;">0.9</span>
                              <span style="color: #a45bad;">:lambda</span> <span style="color: #a45bad;">1e-4</span><span style="color: #67b11d;">}</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>dropout <span style="color: #a45bad;">0.5</span><span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>linear num-classes<span style="color: #2d9574;">)</span>
   <span style="color: #2d9574;">(</span><span style="color: #ce537a; font-weight: bold;">layers</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>softmax <span style="color: #a45bad;">:id</span> <span style="color: #a45bad;">:labels</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">]</span><span style="color: #4f97d7;">)</span>

<span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">create the network to accept 28 x 28 pixel inputs, </span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">10 targets/labels (one each for digits 0-9)</span>
<span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #7590db;">mnist</span> <span style="color: #bc6ec5;">(</span>mnist-initial-description <span style="color: #a45bad;">28</span> <span style="color: #a45bad;">28</span> <span style="color: #a45bad;">10</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

<span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">network</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>print-layer-summary mnist-net <span style="color: #bc6ec5;">(</span><span style="color: #ce537a; font-weight: bold;">traverse</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>training-traversal mnist-net<span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>

</pre>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org24d099f">
<h4 id="org24d099f">Part 2</h4>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">type</th>
<th scope="col" class="org-left">input</th>
<th scope="col" class="org-left">output</th>
<th scope="col" class="org-left">:bias</th>
<th scope="col" class="org-left">:weights</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">:linear</td>
<td class="org-left">50x4x4 - 800</td>
<td class="org-left">1x1x1000 - 1000</td>
<td class="org-left">[1000]</td>
<td class="org-left">[1000 800]</td>
</tr>

<tr>
<td class="org-left">:relu</td>
<td class="org-left">1x1x1000 - 1000</td>
<td class="org-left">1x1x1000 - 1000</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">:dropout</td>
<td class="org-left">1x1x1000 - 1000</td>
<td class="org-left">1x1x1000 - 1000</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>

<tr>
<td class="org-left">:linear</td>
<td class="org-left">1x1x1000 - 1000</td>
<td class="org-left">1x1x10 - 10</td>
<td class="org-left">[10]</td>
<td class="org-left">[10 1000]</td>
</tr>

<tr>
<td class="org-left">:softmax</td>
<td class="org-left">1x1x10 - 10</td>
<td class="org-left">1x1x10 - 10</td>
<td class="org-left">&#xa0;</td>
<td class="org-left">&#xa0;</td>
</tr>
</tbody>
</table>

<p>
Parameter count: 849780
</p>

</section>
<section >

<div class="figure">
<p><img src="./images/weights_barchart.png" alt="weights_barchart.png" />
</p>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org6b4595e">
<h3 id="org6b4595e">Visualize the output of a hidden layer (a.k.a dissoc)</h3>
<p>
Exploring the Swish activation function
</p>

<p class="fragment appear">
Remove the penultimate layer (labels) and pass a range of inputs 
</p>
<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;</span> network <span style="color: #a45bad;">:compute-graph</span> <span style="color: #a45bad;">:nodes</span> keys<span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">(</span><span style="color: #2aa1ae; background-color: #292e34;">:data</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:batch-normalization-1</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:linear-1</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:labels</span><span style="color: #2aa1ae; background-color: #292e34;"> </span><span style="color: #2aa1ae; background-color: #292e34;">:mse-loss-1</span><span style="color: #2aa1ae; background-color: #292e34;">)</span>
</pre>
</div>

<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #ce537a; font-weight: bold;">execute</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>run <span style="color: #bc6ec5;">(</span><span style="color: #ce537a; font-weight: bold;">network</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>dissoc-layers-from-network network <span style="color: #a45bad;">:labels</span><span style="color: #bc6ec5;">)</span> input-data<span style="color: #4f97d7;">)</span>
</pre>
</div>

</section>
<section >

<p>
Compare Swish with Tanh and Logistic layers
</p>


<div class="figure">
<p><img src="./images/swish4.png" alt="swish4.png" />
</p>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-orgd343417">
<h3 id="orgd343417">Training (a.k.a iterate)</h3>
<p>
Train and test datasets are infinite sequences
</p>

<div class="org-src-container">

<pre  class="fragment appear"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">def</span> <span style="color: #7590db;">trained-net</span>
 <span style="color: #bc6ec5;">(</span><span style="color: #4f97d7; font-weight: bold;">let</span> <span style="color: #2d9574;">[</span><span style="color: #67b11d;">[</span>train-ds test-ds<span style="color: #67b11d;">]</span> <span style="color: #67b11d;">(</span>get-ds<span style="color: #67b11d;">)</span>
         train-fn #<span style="color: #67b11d;">(</span><span style="color: #ce537a; font-weight: bold;">etrain</span><span style="color: #b2b2b2; background-color: #292b2e;">/</span>train-n <span style="color: #7590db;">%</span> train-ds test-ds<span style="color: #67b11d;">)</span><span style="color: #2d9574;">]</span>
     <span style="color: #2d9574;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;&gt;</span> network
          <span style="color: #67b11d;">(</span>iterate train-fn<span style="color: #67b11d;">)</span>
          <span style="color: #67b11d;">(</span>take <span style="color: #a45bad;">10</span><span style="color: #67b11d;">)</span><span style="color: #2d9574;">)</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

</section>
<section >
<p>
Returns a sequence with 10 iterations of trained network
</p>

<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;&gt;</span> trained-net <span style="color: #bc6ec5;">(</span>mapv <span style="color: #a45bad;">:cv-loss</span><span style="color: #bc6ec5;">)</span><span style="color: #4f97d7;">)</span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span>
<span style="color: #2aa1ae; background-color: #292e34;">;;</span><span style="color: #2aa1ae; background-color: #292e34;">[nil 2.2406814049004633 </span>
<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">2.1851172560486454 2.1851172560486454 </span>
<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">2.1851172560486454 2.1822464148167136 </span>
<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">2.1734111466403503 2.1614423794394315 </span>
<span style="color: #2aa1ae; background-color: #292e34;">;; </span><span style="color: #2aa1ae; background-color: #292e34;">2.1614423794394315 2.1614423794394315]</span>

</pre>
</div>

</section>
<section >

<p>
Check how weights change over epochs
</p>

<div class="org-src-container">

<pre  class="src src-clojure"><span style="color: #4f97d7;">(</span><span style="color: #4f97d7; font-weight: bold;">-&gt;</span> network <span style="color: #a45bad;">:compute-graph</span> <span style="color: #a45bad;">:buffers</span> <span style="color: #a45bad;">:convolutional-2-weights-1</span> <span style="color: #a45bad;">:buffer</span><span style="color: #4f97d7;">)</span>
</pre>
</div>

</section>
<section >

<div class="figure">
<p><img src="./images/conv_layer_weights.png" alt="conv_layer_weights.png" />
</p>
<p><span class="figure-number">Figure 22: </span>Convolution layer weights</p>
</div>

<div class="slide-footer"></div>
</section>
<section id="slide-org8d77d40">
<h3 id="org8d77d40">Listeners</h3>
<p class="fragment appear">
To watch progress of the loss function
</p>
<p class="fragment appear">
Save the best model/kill training
</p>
<p class="fragment appear">
Observe images/instances being classified
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgad6f9a1">
<h2 id="orgad6f9a1">Summary</h2>


<div class="slide-footer"></div>
</section>
<section id="slide-org48bfb84">
<h3 id="org48bfb84">What Cortex needs contributions on</h3>
<p class="fragment appear">
Support for Recurrent networks (e.g. text) 
</p>
<p class="fragment appear">
Java based alternative is Deeplearning4j
</p>
<p class="fragment appear">
Recent network structures (e.g. Inception / Capsule networks). 
</p>
<p class="fragment appear">
Ingesting pre-trained networks
</p>
<p class="fragment appear">
Automatic differentiation
</p>

<div class="slide-footer"></div>
</section>
</section>
<section>
<section id="slide-orgb392ae4">
<h2 id="orgb392ae4">Thanks</h2>
<p>
Chris Nuernberger and the Thinktopic team
</p>
<p class="fragment appear">
Mike Anderson 
</p>

</section>
<section >
</section>
<section >
</section>
<section >
</section>
<section >

<div class="slide-footer"></div>
</section>
<section id="slide-org47ecf2c">
<h4 id="org47ecf2c">References</h4>
<ul>
<li><a href="http://clojuredatascience.com">Clojure Data Science.com</a></li>
<li>Office occupancy picture (<img src="https://c1.staticflickr.com/1/31/65165707_a9ee8be5e0_b.jpg" alt="65165707_a9ee8be5e0_b.jpg" />)</li>

</ul>
<div class="slide-footer"></div>
</section>
</section>
</div>
</div>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/lib/js/head.min.js"></script>
<script src="http://cdn.jsdelivr.net/reveal.js/3.0.0/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
overview: true,
maxScale: 5.00,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'http://cdn.jsdelivr.net/reveal.js/3.0.0/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
